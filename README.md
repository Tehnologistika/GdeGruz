# GdeGruz

This repository outlines a minimal setup for a Telegram bot built with **Aiogram 3** alongside a **FastAPI** web API. The project demonstrates persistence using **SQLite**, containerization with **Docker** and **docker-compose**, and a GitHub Actions workflow for deployment.

## Project tree

```text
.
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îî‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ web/
‚îÇ   ‚îî‚îÄ‚îÄ api.py
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îî‚îÄ‚îÄ map.html
‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îî‚îÄ‚îÄ bot.conf
‚îú‚îÄ‚îÄ db.py
‚îú‚îÄ‚îÄ deploy.sh
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îî‚îÄ‚îÄ deploy.yml
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

## requirements.txt

```text
aiogram==3.0.0
fastapi==0.103.1       # —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å typing-extensions 4.7.*
aiosqlite==0.19.0
python-dotenv==1.0.1
uvicorn==0.29.0
jinja2==3.1.3
```

## Usage

1. `/start` ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ.
2. –ù–∞–∂–∏–º–∞—Ç—å –∫–Ω–æ–ø–∫—É —Ä–∞–∑ –≤ 24 —á.
3. Live Location –∏–¥—ë—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
4. –ë–æ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç, –µ—Å–ª–∏ –≤–æ–¥–∏—Ç–µ–ª—å –∑–∞–±—ã–ª.

## –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üìã –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–π—Å–∞–º–∏

–¢–µ–ø–µ—Ä—å –≤—Å–µ —Ä–µ–π—Å—ã —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ:

**–î–ª—è –≤–æ–¥–∏—Ç–µ–ª–µ–π:**
- –ö–æ–º–∞–Ω–¥–∞ `/trips` –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ "üìã –ú–æ–∏ —Ä–µ–π—Å—ã" - —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–µ–π—Å–æ–≤
- –ö–∞—Ä—Ç–æ—á–∫–∏ —Ä–µ–π—Å–æ–≤ —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å—Ç–∞—Ç—É—Å–∞ —Ä–µ–π—Å–∞
- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (—Ñ–æ—Ç–æ, –¥–æ–∫—É–º–µ–Ω—Ç—ã, –ø—Ä–æ–±–ª–µ–º—ã)

**–î–ª—è –∫—É—Ä–∞—Ç–æ—Ä–æ–≤ (—á–µ—Ä–µ–∑ API):**
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Å–∞–º–∏
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
- –ò—Å—Ç–æ—Ä–∏—è —Å–æ–±—ã—Ç–∏–π –ø–æ –∫–∞–∂–¥–æ–º—É —Ä–µ–π—Å—É
- –ü—Ä–∏–≤—è–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∫ —Ä–µ–π—Å–∞–º

**API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
```
POST   /api/trips/create          - —Å–æ–∑–¥–∞—Ç—å —Ä–µ–π—Å
GET    /api/trips/{id}             - –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–π—Å
PUT    /api/trips/{id}             - –æ–±–Ω–æ–≤–∏—Ç—å —Ä–µ–π—Å
GET    /api/trips/                 - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–µ–π—Å–æ–≤
GET    /api/trips/{id}/documents   - –¥–æ–∫—É–º–µ–Ω—Ç—ã —Ä–µ–π—Å–∞
GET    /api/trips/{id}/events      - –∏—Å—Ç–æ—Ä–∏—è —Å–æ–±—ã—Ç–∏–π
GET    /api/trips/{id}/summary     - –ø–æ–ª–Ω–∞—è —Å–≤–æ–¥–∫–∞
```

**–°—Ç–∞—Ç—É—Å—ã —Ä–µ–π—Å–æ–≤:**
- üìã `created` - –°–æ–∑–¥–∞–Ω
- üì¶ `loading` - –ü–æ–≥—Ä—É–∑–∫–∞
- üöö `in_transit` - –í –ø—É—Ç–∏
- üì• `unloading` - –í—ã–≥—Ä—É–∑–∫–∞
- ‚úÖ `completed` - –ó–∞–≤–µ—Ä—à—ë–Ω
- ‚ùå `cancelled` - –û—Ç–º–µ–Ω—ë–Ω

### üì§ –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

**–î–ª—è –≤–æ–¥–∏—Ç–µ–ª–µ–π:**
- –ö–æ–º–∞–Ω–¥–∞ `/documents` –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ "üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã"
- –ó–∞–≥—Ä—É–∑–∫–∞ 5 —Ç–∏–ø–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:
  - üì∏ –§–æ—Ç–æ –ø–æ–≥—Ä—É–∑–∫–∏
  - üì∏ –§–æ—Ç–æ –≤—ã–≥—Ä—É–∑–∫–∏
  - üìÑ –¢–¢–ù (—Ç–æ–≤–∞—Ä–Ω–æ-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –Ω–∞–∫–ª–∞–¥–Ω–∞—è)
  - üìÑ –£–ü–î (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç)
  - üìÑ –î—Ä—É–≥–æ–π –¥–æ–∫—É–º–µ–Ω—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∫ –∞–∫—Ç–∏–≤–Ω—ã–º —Ä–µ–π—Å–∞–º
- –ö–æ–º–∞–Ω–¥–∞ `/my_documents` - –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ –≥—Ä—É–ø–ø—É:**
- –î–æ–∫—É–º–µ–Ω—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –≥—Ä—É–ø–ø—É —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–æ–¥–∏—Ç–µ–ª–µ, —Ä–µ–π—Å–µ, –¥–∞—Ç–µ –∑–∞–≥—Ä—É–∑–∫–∏

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–∏ SQLite –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

1. **drivers.db** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–æ–¥–∏—Ç–µ–ª—è—Ö –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
2. **trips.db** - —Ä–µ–π—Å—ã –∏ —Å–æ–±—ã—Ç–∏—è —Ä–µ–π—Å–æ–≤
3. **documents.db** - –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤–æ–¥–∏—Ç–µ–ª–µ–π

